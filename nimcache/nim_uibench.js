/* Generated by the Nim Compiler v0.16.1 */
/*   (c) 2017 Andreas Rumpf */

var framePtr = null;
var excHandler = 0;
var lastJSError = null;
if (typeof Int8Array === 'undefined') Int8Array = Array;
if (typeof Int16Array === 'undefined') Int16Array = Array;
if (typeof Int32Array === 'undefined') Int32Array = Array;
if (typeof Uint8Array === 'undefined') Uint8Array = Array;
if (typeof Uint16Array === 'undefined') Uint16Array = Array;
if (typeof Uint32Array === 'undefined') Uint32Array = Array;
if (typeof Float32Array === 'undefined') Float32Array = Array;
if (typeof Float64Array === 'undefined') Float64Array = Array;
var NTI76002 = {size: 0, kind: 14, base: null, node: null, finalizer: null};
var NTI76458 = {size: 0,kind: 16,base: null,node: null,finalizer: null};
var NTI76452 = {size: 0,kind: 16,base: null,node: null,finalizer: null};
var NTI30240 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI30208 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI27038 = {size: 0,kind: 28,base: null,node: null,finalizer: null};
var NTI27040 = {size: 0,kind: 29,base: null,node: null,finalizer: null};
var NTI30287 = {size: 0,kind: 22,base: null,node: null,finalizer: null};
var NTI30224 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI30238 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI30242 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NNI30242 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI30242.node = NNI30242;
var NNI30238 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI30238.node = NNI30238;
NTI30287.base = NTI30224;
var NNI30224 = {kind: 2, len: 4, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "parent", len: 0, typ: NTI30287, name: "parent", sons: null}, 
{kind: 1, offset: "name", len: 0, typ: NTI27040, name: "name", sons: null}, 
{kind: 1, offset: "message", len: 0, typ: NTI27038, name: "msg", sons: null}, 
{kind: 1, offset: "trace", len: 0, typ: NTI27038, name: "trace", sons: null}]};
NTI30224.node = NNI30224;
var NNI30208 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI30208.node = NNI30208;
NTI30224.base = NTI30208;
NTI30238.base = NTI30224;
NTI30242.base = NTI30238;
var NNI30240 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI30240.node = NNI30240;
NTI30240.base = NTI30238;
NTI76452.base = NTI27040;
NTI76458.base = NTI27040;
var NNI76002 = {kind: 2, offset: 0, typ: null, name: null, len: 116, sons: {"0": {kind: 1, offset: 0, typ: NTI76002, name: "#text", len: 0, sons: null}, 
"1": {kind: 1, offset: 1, typ: NTI76002, name: "#int", len: 0, sons: null}, 
"2": {kind: 1, offset: 2, typ: NTI76002, name: "#bool", len: 0, sons: null}, 
"3": {kind: 1, offset: 3, typ: NTI76002, name: "#vthunk", len: 0, sons: null}, 
"4": {kind: 1, offset: 4, typ: NTI76002, name: "#dthunk", len: 0, sons: null}, 
"5": {kind: 1, offset: 5, typ: NTI76002, name: "html", len: 0, sons: null}, 
"6": {kind: 1, offset: 6, typ: NTI76002, name: "head", len: 0, sons: null}, 
"7": {kind: 1, offset: 7, typ: NTI76002, name: "title", len: 0, sons: null}, 
"8": {kind: 1, offset: 8, typ: NTI76002, name: "base", len: 0, sons: null}, 
"9": {kind: 1, offset: 9, typ: NTI76002, name: "link", len: 0, sons: null}, 
"10": {kind: 1, offset: 10, typ: NTI76002, name: "meta", len: 0, sons: null}, 
"11": {kind: 1, offset: 11, typ: NTI76002, name: "style", len: 0, sons: null}, 
"12": {kind: 1, offset: 12, typ: NTI76002, name: "script", len: 0, sons: null}, 
"13": {kind: 1, offset: 13, typ: NTI76002, name: "noscript", len: 0, sons: null}, 
"14": {kind: 1, offset: 14, typ: NTI76002, name: "body", len: 0, sons: null}, 
"15": {kind: 1, offset: 15, typ: NTI76002, name: "section", len: 0, sons: null}, 
"16": {kind: 1, offset: 16, typ: NTI76002, name: "nav", len: 0, sons: null}, 
"17": {kind: 1, offset: 17, typ: NTI76002, name: "article", len: 0, sons: null}, 
"18": {kind: 1, offset: 18, typ: NTI76002, name: "aside", len: 0, sons: null}, 
"19": {kind: 1, offset: 19, typ: NTI76002, name: "h1", len: 0, sons: null}, 
"20": {kind: 1, offset: 20, typ: NTI76002, name: "h2", len: 0, sons: null}, 
"21": {kind: 1, offset: 21, typ: NTI76002, name: "h3", len: 0, sons: null}, 
"22": {kind: 1, offset: 22, typ: NTI76002, name: "h4", len: 0, sons: null}, 
"23": {kind: 1, offset: 23, typ: NTI76002, name: "h5", len: 0, sons: null}, 
"24": {kind: 1, offset: 24, typ: NTI76002, name: "h6", len: 0, sons: null}, 
"25": {kind: 1, offset: 25, typ: NTI76002, name: "header", len: 0, sons: null}, 
"26": {kind: 1, offset: 26, typ: NTI76002, name: "footer", len: 0, sons: null}, 
"27": {kind: 1, offset: 27, typ: NTI76002, name: "address", len: 0, sons: null}, 
"28": {kind: 1, offset: 28, typ: NTI76002, name: "main", len: 0, sons: null}, 
"29": {kind: 1, offset: 29, typ: NTI76002, name: "p", len: 0, sons: null}, 
"30": {kind: 1, offset: 30, typ: NTI76002, name: "hr", len: 0, sons: null}, 
"31": {kind: 1, offset: 31, typ: NTI76002, name: "pre", len: 0, sons: null}, 
"32": {kind: 1, offset: 32, typ: NTI76002, name: "blockquote", len: 0, sons: null}, 
"33": {kind: 1, offset: 33, typ: NTI76002, name: "ol", len: 0, sons: null}, 
"34": {kind: 1, offset: 34, typ: NTI76002, name: "ul", len: 0, sons: null}, 
"35": {kind: 1, offset: 35, typ: NTI76002, name: "li", len: 0, sons: null}, 
"36": {kind: 1, offset: 36, typ: NTI76002, name: "dl", len: 0, sons: null}, 
"37": {kind: 1, offset: 37, typ: NTI76002, name: "dt", len: 0, sons: null}, 
"38": {kind: 1, offset: 38, typ: NTI76002, name: "dd", len: 0, sons: null}, 
"39": {kind: 1, offset: 39, typ: NTI76002, name: "figure", len: 0, sons: null}, 
"40": {kind: 1, offset: 40, typ: NTI76002, name: "figcaption", len: 0, sons: null}, 
"41": {kind: 1, offset: 41, typ: NTI76002, name: "div", len: 0, sons: null}, 
"42": {kind: 1, offset: 42, typ: NTI76002, name: "a", len: 0, sons: null}, 
"43": {kind: 1, offset: 43, typ: NTI76002, name: "em", len: 0, sons: null}, 
"44": {kind: 1, offset: 44, typ: NTI76002, name: "strong", len: 0, sons: null}, 
"45": {kind: 1, offset: 45, typ: NTI76002, name: "small", len: 0, sons: null}, 
"46": {kind: 1, offset: 46, typ: NTI76002, name: "s", len: 0, sons: null}, 
"47": {kind: 1, offset: 47, typ: NTI76002, name: "cite", len: 0, sons: null}, 
"48": {kind: 1, offset: 48, typ: NTI76002, name: "quote", len: 0, sons: null}, 
"49": {kind: 1, offset: 49, typ: NTI76002, name: "dfn", len: 0, sons: null}, 
"50": {kind: 1, offset: 50, typ: NTI76002, name: "abbr", len: 0, sons: null}, 
"51": {kind: 1, offset: 51, typ: NTI76002, name: "data", len: 0, sons: null}, 
"52": {kind: 1, offset: 52, typ: NTI76002, name: "time", len: 0, sons: null}, 
"53": {kind: 1, offset: 53, typ: NTI76002, name: "code", len: 0, sons: null}, 
"54": {kind: 1, offset: 54, typ: NTI76002, name: "var", len: 0, sons: null}, 
"55": {kind: 1, offset: 55, typ: NTI76002, name: "samp", len: 0, sons: null}, 
"56": {kind: 1, offset: 56, typ: NTI76002, name: "kdb", len: 0, sons: null}, 
"57": {kind: 1, offset: 57, typ: NTI76002, name: "sub", len: 0, sons: null}, 
"58": {kind: 1, offset: 58, typ: NTI76002, name: "sup", len: 0, sons: null}, 
"59": {kind: 1, offset: 59, typ: NTI76002, name: "i", len: 0, sons: null}, 
"60": {kind: 1, offset: 60, typ: NTI76002, name: "b", len: 0, sons: null}, 
"61": {kind: 1, offset: 61, typ: NTI76002, name: "u", len: 0, sons: null}, 
"62": {kind: 1, offset: 62, typ: NTI76002, name: "mark", len: 0, sons: null}, 
"63": {kind: 1, offset: 63, typ: NTI76002, name: "ruby", len: 0, sons: null}, 
"64": {kind: 1, offset: 64, typ: NTI76002, name: "rt", len: 0, sons: null}, 
"65": {kind: 1, offset: 65, typ: NTI76002, name: "rp", len: 0, sons: null}, 
"66": {kind: 1, offset: 66, typ: NTI76002, name: "bdi", len: 0, sons: null}, 
"67": {kind: 1, offset: 67, typ: NTI76002, name: "dbo", len: 0, sons: null}, 
"68": {kind: 1, offset: 68, typ: NTI76002, name: "span", len: 0, sons: null}, 
"69": {kind: 1, offset: 69, typ: NTI76002, name: "br", len: 0, sons: null}, 
"70": {kind: 1, offset: 70, typ: NTI76002, name: "wbr", len: 0, sons: null}, 
"71": {kind: 1, offset: 71, typ: NTI76002, name: "ins", len: 0, sons: null}, 
"72": {kind: 1, offset: 72, typ: NTI76002, name: "del", len: 0, sons: null}, 
"73": {kind: 1, offset: 73, typ: NTI76002, name: "img", len: 0, sons: null}, 
"74": {kind: 1, offset: 74, typ: NTI76002, name: "iframe", len: 0, sons: null}, 
"75": {kind: 1, offset: 75, typ: NTI76002, name: "embed", len: 0, sons: null}, 
"76": {kind: 1, offset: 76, typ: NTI76002, name: "object", len: 0, sons: null}, 
"77": {kind: 1, offset: 77, typ: NTI76002, name: "param", len: 0, sons: null}, 
"78": {kind: 1, offset: 78, typ: NTI76002, name: "video", len: 0, sons: null}, 
"79": {kind: 1, offset: 79, typ: NTI76002, name: "audio", len: 0, sons: null}, 
"80": {kind: 1, offset: 80, typ: NTI76002, name: "source", len: 0, sons: null}, 
"81": {kind: 1, offset: 81, typ: NTI76002, name: "track", len: 0, sons: null}, 
"82": {kind: 1, offset: 82, typ: NTI76002, name: "canvas", len: 0, sons: null}, 
"83": {kind: 1, offset: 83, typ: NTI76002, name: "map", len: 0, sons: null}, 
"84": {kind: 1, offset: 84, typ: NTI76002, name: "area", len: 0, sons: null}, 
"85": {kind: 1, offset: 85, typ: NTI76002, name: "svg", len: 0, sons: null}, 
"86": {kind: 1, offset: 86, typ: NTI76002, name: "math", len: 0, sons: null}, 
"87": {kind: 1, offset: 87, typ: NTI76002, name: "table", len: 0, sons: null}, 
"88": {kind: 1, offset: 88, typ: NTI76002, name: "caption", len: 0, sons: null}, 
"89": {kind: 1, offset: 89, typ: NTI76002, name: "colgroup", len: 0, sons: null}, 
"90": {kind: 1, offset: 90, typ: NTI76002, name: "col", len: 0, sons: null}, 
"91": {kind: 1, offset: 91, typ: NTI76002, name: "tbody", len: 0, sons: null}, 
"92": {kind: 1, offset: 92, typ: NTI76002, name: "thead", len: 0, sons: null}, 
"93": {kind: 1, offset: 93, typ: NTI76002, name: "tfoot", len: 0, sons: null}, 
"94": {kind: 1, offset: 94, typ: NTI76002, name: "tr", len: 0, sons: null}, 
"95": {kind: 1, offset: 95, typ: NTI76002, name: "td", len: 0, sons: null}, 
"96": {kind: 1, offset: 96, typ: NTI76002, name: "th", len: 0, sons: null}, 
"97": {kind: 1, offset: 97, typ: NTI76002, name: "form", len: 0, sons: null}, 
"98": {kind: 1, offset: 98, typ: NTI76002, name: "fieldset", len: 0, sons: null}, 
"99": {kind: 1, offset: 99, typ: NTI76002, name: "legend", len: 0, sons: null}, 
"100": {kind: 1, offset: 100, typ: NTI76002, name: "label", len: 0, sons: null}, 
"101": {kind: 1, offset: 101, typ: NTI76002, name: "input", len: 0, sons: null}, 
"102": {kind: 1, offset: 102, typ: NTI76002, name: "button", len: 0, sons: null}, 
"103": {kind: 1, offset: 103, typ: NTI76002, name: "select", len: 0, sons: null}, 
"104": {kind: 1, offset: 104, typ: NTI76002, name: "datalist", len: 0, sons: null}, 
"105": {kind: 1, offset: 105, typ: NTI76002, name: "optgroup", len: 0, sons: null}, 
"106": {kind: 1, offset: 106, typ: NTI76002, name: "option", len: 0, sons: null}, 
"107": {kind: 1, offset: 107, typ: NTI76002, name: "textarea", len: 0, sons: null}, 
"108": {kind: 1, offset: 108, typ: NTI76002, name: "keygen", len: 0, sons: null}, 
"109": {kind: 1, offset: 109, typ: NTI76002, name: "output", len: 0, sons: null}, 
"110": {kind: 1, offset: 110, typ: NTI76002, name: "progress", len: 0, sons: null}, 
"111": {kind: 1, offset: 111, typ: NTI76002, name: "meter", len: 0, sons: null}, 
"112": {kind: 1, offset: 112, typ: NTI76002, name: "details", len: 0, sons: null}, 
"113": {kind: 1, offset: 113, typ: NTI76002, name: "summary", len: 0, sons: null}, 
"114": {kind: 1, offset: 114, typ: NTI76002, name: "command", len: 0, sons: null}, 
"115": {kind: 1, offset: 115, typ: NTI76002, name: "menu", len: 0, sons: null}}};
NTI76002.node = NNI76002;
function makeNimstrLit(c_40803) {

    var ln = c_40803.length;
    var result = new Array(ln + 1);
    var i = 0;
    for (; i < ln; ++i) {
      result[i] = c_40803.charCodeAt(i);
    }
    result[i] = 0; // terminating zero
    return result;
    }
function SetConstr() {

      var result = {};
      for (var i = 0; i < arguments.length; ++i) {
        var x = arguments[i];
        if (typeof(x) == "object") {
          for (var j = x[0]; j <= x[1]; ++j) {
            result[j] = true;
          }
        } else {
          result[x] = true;
        }
      }
      return result;
    }
function nimCopy(dest_46017, src_46018, ti_46019) {

var result_46429 = null;
switch (ti_46019.kind) {
case 21: case 22: case 23: case 5: if (!(isFatPointer_46001(ti_46019))) {
result_46429 = src_46018;
}
else {
result_46429 = [src_46018[0], src_46018[1]];}


break;
case 19:       if (dest_46017 === null || dest_46017 === undefined) {
        dest_46017 = {};
      }
      else {
        for (var key in dest_46017) { delete dest_46017[key]; }
      }
      for (var key in src_46018) { dest_46017[key] = src_46018[key]; }
      result_46429 = dest_46017;
    
break;
case 18: case 17: if (!((ti_46019.base == null))) {
result_46429 = nimCopy(dest_46017, src_46018, ti_46019.base);
}
else {
if ((ti_46019.kind == 17)) {
result_46429 = (dest_46017 === null || dest_46017 === undefined) ? {m_type: ti_46019} : dest_46017;}
else {
result_46429 = (dest_46017 === null || dest_46017 === undefined) ? {} : dest_46017;}
}
nimCopyAux(result_46429, src_46018, ti_46019.node);

break;
case 24: case 4: case 27: case 16:       if (src_46018 === null) {
        result_46429 = null;
      }
      else {
        if (dest_46017 === null || dest_46017 === undefined) {
          dest_46017 = new Array(src_46018.length);
        }
        else {
          dest_46017.length = src_46018.length;
        }
        result_46429 = dest_46017;
        for (var i = 0; i < src_46018.length; ++i) {
          result_46429[i] = nimCopy(result_46429[i], src_46018[i], ti_46019.base);
        }
      }
    
break;
case 28:       if (src_46018 !== null) {
        result_46429 = src_46018.slice(0);
      }
    
break;
default: 
result_46429 = src_46018;
break;
}
return result_46429;
}
function eqStrings(a_43403, b_43404) {

    if (a_43403 == b_43404) return true;
    if ((!a_43403) || (!b_43404)) return false;
    var alen = a_43403.length;
    if (alen != b_43404.length) return false;
    for (var i = 0; i < alen; ++i)
      if (a_43403[i] != b_43404[i]) return false;
    return true;
  }
function toJSStr(s_41203) {

    var len = s_41203.length-1;
    var asciiPart = new Array(len);
    var fcc = String.fromCharCode;
    var nonAsciiPart = null;
    var nonAsciiOffset = 0;
    for (var i = 0; i < len; ++i) {
      if (nonAsciiPart !== null) {
        var offset = (i - nonAsciiOffset) * 2;
        var code = s_41203[i].toString(16);
        if (code.length == 1) {
          code = "0"+code;
        }
        nonAsciiPart[offset] = "%";
        nonAsciiPart[offset + 1] = code;
      }
      else if (s_41203[i] < 128)
        asciiPart[i] = fcc(s_41203[i]);
      else {
        asciiPart.length = i;
        nonAsciiOffset = i;
        nonAsciiPart = new Array((len - i) * 2);
        --i;
      }
    }
    asciiPart = asciiPart.join("");
    return (nonAsciiPart === null) ?
        asciiPart : asciiPart + decodeURIComponent(nonAsciiPart.join(""));
  }
function raiseException(e_40206, ename_40207) {

e_40206.name = ename_40207;
if ((excHandler == 0)) {
unhandledException(e_40206);
}

throw e_40206;}
var toTag_76449 = nimCopy(null, ["#text", "#int", "#bool", "#vthunk", "#dthunk", "HTML", "HEAD", "TITLE", "BASE", "LINK", "META", "STYLE", "SCRIPT", "NOSCRIPT", "BODY", "SECTION", "NAV", "ARTICLE", "ASIDE", "H1", "H2", "H3", "H4", "H5", "H6", "HEADER", "FOOTER", "ADDRESS", "MAIN", "P", "HR", "PRE", "BLOCKQUOTE", "OL", "UL", "LI", "DL", "DT", "DD", "FIGURE", "FIGCAPTION", "DIV", "A", "EM", "STRONG", "SMALL", "S", "CITE", "QUOTE", "DFN", "ABBR", "DATA", "TIME", "CODE", "VAR", "SAMP", "KDB", "SUB", "SUP", "I", "B", "U", "MARK", "RUBY", "RT", "RP", "BDI", "DBO", "SPAN", "BR", "WBR", "INS", "DEL", "IMG", "IFRAME", "EMBED", "OBJECT", "PARAM", "VIDEO", "AUDIO", "SOURCE", "TRACK", "CANVAS", "MAP", "AREA", "SVG", "MATH", "TABLE", "CAPTION", "COLGROUP", "COL", "TBODY", "THEAD", "TFOOT", "TR", "TD", "TH", "FORM", "FIELDSET", "LEGEND", "LABEL", "INPUT", "BUTTON", "SELECT", "DATALIST", "OPTGROUP", "OPTION", "TEXTAREA", "KEYGEN", "OUTPUT", "PROGRESS", "METER", "DETAILS", "SUMMARY", "COMMAND", "MENU"], NTI76452);
var toEventName_76455 = nimCopy(null, ["click", "dblclick", "keyup", "keydown", "keypressed", "blur", "change", "scroll", "mousedown", "mouseenter", "mouseleave", "mousemove", "mouseout", "mouseover", "mouseup", "drag", "dragend", "dragenter", "dragleave", "dragover", "dragstart", "drop", "keyupenter", "keyuplater"], NTI76458);
function nimMin(a_45639, b_45640) {

var Tmp1;
var result_45641 = 0;
BeforeRet: do {
if ((a_45639 <= b_45640)) {
Tmp1 = a_45639;
}
else {
Tmp1 = b_45640;
}

result_45641 = Tmp1;
break BeforeRet;
} while (false); 
return result_45641;
}
function cstrToNimstr(c_41003) {

  var ln = c_41003.length;
  var result = new Array(ln);
  var r = 0;
  for (var i = 0; i < ln; ++i) {
    var ch = c_41003.charCodeAt(i);

    if (ch < 128) {
      result[r] = ch;
    }
    else if((ch > 127) && (ch < 2048)) {
      result[r] = (ch >> 6) | 192;
      ++r;
      result[r] = (ch & 63) | 128;
    }
    else {
      result[r] = (ch >> 12) | 224;
      ++r;
      result[r] = ((ch >> 6) & 63) | 128;
      ++r;
      result[r] = (ch & 63) | 128;
    }
    ++r;
  }
  result[r] = 0; // terminating zero
  return result;
  }
function addChar(x_46706, c_46707) {

    x_46706[x_46706.length-1] = c_46707; x_46706.push(0);
  }
function reprEnum(e_47028, typ_47029) {

var result_47030 = null;
if (!(isUndefined_47032(typ_47029.node.sons[e_47028]))) {
result_47030 = nimCopy(null, cstrToNimstr(typ_47029.node.sons[e_47028].name), NTI27038);
}
else {
result_47030 = nimCopy(null, (cstrToNimstr((e_47028)+"").slice(0,-1)).concat(makeNimstrLit(" (invalid data!)")), NTI27038);
}

return result_47030;
}
var nimvm_32687 = false;
var nim_program_result = 0;
var globalRaiseHook_37805 = [null];
var localRaiseHook_37810 = [null];
var outOfMemHook_37813 = [null];
function isFatPointer_46001(ti_46003) {

var result_46004 = false;
BeforeRet: do {
result_46004 = !((SetConstr(17, 16, 4, 18, 27, 19, 23, 22, 21)[ti_46003.base.kind] != undefined));
break BeforeRet;
} while (false); 
return result_46004;
}
function nimCopyAux(dest_46022, src_46023, n_46025) {

switch (n_46025.kind) {
case 0: 
break;
case 1:       dest_46022[n_46025.offset] = nimCopy(dest_46022[n_46025.offset], src_46023[n_46025.offset], n_46025.typ);
    
break;
case 2: L1: do {
var i_46415 = 0;
var colontmp__46417 = 0;
colontmp__46417 = (n_46025.len - 1);
var res_46420 = 0;
L2: do {
L3: while (true) {
if (!(res_46420 <= colontmp__46417)) break L3;
i_46415 = res_46420;
nimCopyAux(dest_46022, src_46023, n_46025.sons[i_46415]);
res_46420 += 1;
}
} while(false);
} while(false);

break;
case 3:       dest_46022[n_46025.offset] = nimCopy(dest_46022[n_46025.offset], src_46023[n_46025.offset], n_46025.typ);
      for (var i = 0; i < n_46025.sons.length; ++i) {
        nimCopyAux(dest_46022, src_46023, n_46025.sons[i][1]);
      }
    
break;
}
}
function add_37829(x_37832, x_37832_Idx, y_37833) {

        var len = x_37832[0].length-1;
        for (var i = 0; i < y_37833.length; ++i) {
          x_37832[0][len] = y_37833.charCodeAt(i);
          ++len;
        }
        x_37832[0][len] = 0
      }
function unhandledException(e_40053) {

var Tmp1;
var buf_40054 = /**/[makeNimstrLit("")];
if (!!(eqStrings(e_40053.message, null))) Tmp1 = false; else {Tmp1 = !((e_40053.message[0] == 0)); }if (Tmp1) {
if (buf_40054[0] != null) { buf_40054[0] = (buf_40054[0].slice(0, -1)).concat(makeNimstrLit("Error: unhandled exception: ")); } else { buf_40054[0] = makeNimstrLit("Error: unhandled exception: ");};
if (buf_40054[0] != null) { buf_40054[0] = (buf_40054[0].slice(0, -1)).concat(e_40053.message); } else { buf_40054[0] = e_40053.message;};
}
else {
if (buf_40054[0] != null) { buf_40054[0] = (buf_40054[0].slice(0, -1)).concat(makeNimstrLit("Error: unhandled exception")); } else { buf_40054[0] = makeNimstrLit("Error: unhandled exception");};
}

if (buf_40054[0] != null) { buf_40054[0] = (buf_40054[0].slice(0, -1)).concat(makeNimstrLit(" [")); } else { buf_40054[0] = makeNimstrLit(" [");};
add_37829(buf_40054, 0, e_40053.name);
if (buf_40054[0] != null) { buf_40054[0] = (buf_40054[0].slice(0, -1)).concat(makeNimstrLit("]\x0A")); } else { buf_40054[0] = makeNimstrLit("]\x0A");};
var cbuf_40201 = toJSStr(buf_40054[0]);
framePtr = null;
  if (typeof(Error) !== "undefined") {
    throw new Error(cbuf_40201);
  }
  else {
    throw cbuf_40201;
  }
  }
function raiseOverflow() {

var e_40640 = null;
e_40640 = {m_type: NTI30242, parent: null, name: null, message: null, trace: null};
e_40640.message = nimCopy(null, makeNimstrLit("over- or underflow"), NTI27038);
e_40640.parent = null;
raiseException(e_40640, "OverflowError");
}
function raiseDivByZero() {

var e_40658 = null;
e_40658 = {m_type: NTI30240, parent: null, name: null, message: null, trace: null};
e_40658.message = nimCopy(null, makeNimstrLit("division by zero"), NTI27038);
e_40658.parent = null;
raiseException(e_40658, "DivByZeroError");
}
var objectID_80232 = /**/[0];
var dirty_87054 = /**/[{}];
var someDirty_87055 = [false];
var vcomponents_87126 = /**/[{}];
var dcomponents_87138 = /**/[{}];
var toFocus_89021 = [null];
var toFocusV_89022 = [null];
var dorender_89480 = [null];
var currentTree_89481 = [null];
var appState_94089 = [null];
uibench.init("Nim-karax-new", "0.6.1");
function setRendererOnly_90811(renderer_90815) {

dorender_89480[0] = renderer_90815;
}
function newVNode_76928(kind_76930) {

var result_76931 = null;
result_76931 = {kind: kind_76930, key: -1, id: null, class: null, text: null, track: 0, kids: null, attrs: null, events: null, dom: null};
return result_76931;
}
function add_76914(parent_76916, kid_76917) {

if (parent_76916.kids != null) { parent_76916.kids.push(kid_76917); } else { parent_76916.kids = [kid_76917]; };
}
function tree_76933(kind_76935, kids_76937) {

var result_76938 = null;
result_76938 = newVNode_76928(kind_76935);
L1: do {
var k_76963 = null;
var i_76967 = 0;
L2: do {
L3: while (true) {
if (!(i_76967 < (kids_76937 != null ? kids_76937.length : 0))) break L3;
k_76963 = kids_76937[i_76967];
add_76914(result_76938, k_76963);
i_76967 += 1;
}
} while(false);
} while(false);
return result_76938;
}
function setAttr_76716(n_76718, key_76719, val_76720) {

BeforeRet: do {
if ((n_76718.attrs === null)) {
var x_76813 = [key_76719, val_76720];
n_76718.attrs = x_76813;
}
else {
L1: do {
var i_76832 = 0;
var colontmp__76854 = 0;
colontmp__76854 = ((n_76718.attrs != null ? n_76718.attrs.length : 0) - 2);
var res_76857 = 0;
L2: do {
L3: while (true) {
if (!(res_76857 <= colontmp__76854)) break L3;
i_76832 = res_76857;
if ((n_76718.attrs[i_76832] == key_76719)) {
n_76718.attrs[(i_76832 + 1)] = val_76720;
break BeforeRet;
}

res_76857 += 2;
}
} while(false);
} while(false);
if (n_76718.attrs != null) { n_76718.attrs.push(key_76719); } else { n_76718.attrs = [key_76719]; };
if (n_76718.attrs != null) { n_76718.attrs.push(val_76720); } else { n_76718.attrs = [val_76720]; };
}

} while (false); 
}
function addEventListener_77118(n_77120, event_77121, handler_77122) {

if (n_77120.events != null) { n_77120.events.push({Field0: event_77121, Field1: handler_77122}); } else { n_77120.events = [{Field0: event_77121, Field1: handler_77122}]; };
}
function key_89013(e_89015) {

var result_89016 = 0;
if ((e_89015.hasOwnProperty("karaxKey"))) {
result_89016 = e_89015.karaxKey;
}
else {
result_89016 = -1;
}

return result_89016;
}
function valueeq__76510(n_76512, v_76513) {

n_76512.text = v_76513;
}
function value_76506(n_76508) {

var result_76509 = null;
result_76509 = n_76508.text;
return result_76509;
}
function wrapEvent_89047(d_89049, n_89050, k_89051, action_89052) {

function laterWrapper_89078() {

function colonanonymous__89087(ev_89089) {

function wrapper_89090() {

valueeq__76510(n_89085, ev_89089.target.value);
action_89084(ev_89089, n_89085);
ev_89089.target.value = value_76506(n_89085);
}
if (!((timer_89086 == null))) {
clearTimeout(timer_89086);
}

timer_89086 = setTimeout(wrapper_89090, 400);
}
var result_89083 = null;
var action_89084 = action_89052;
var n_89085 = n_89050;
var timer_89086 = null;
result_89083 = colonanonymous__89087;
return result_89083;
}
function enterWrapper_89064() {

function colonanonymous__89072(ev_89074) {

if ((ev_89074.keyCode == 13)) {
valueeq__76510(n_89071, ev_89074.target.value);
action_89070(ev_89074, n_89071);
ev_89074.target.value = value_76506(n_89071);
}

}
var result_89069 = null;
var action_89070 = action_89052;
var n_89071 = n_89050;
result_89069 = colonanonymous__89072;
return result_89069;
}
function stdWrapper_89053() {

function colonanonymous__89061(ev_89063) {

action_89059(ev_89063, n_89060);
}
var result_89058 = null;
var action_89059 = action_89052;
var n_89060 = n_89050;
result_89058 = colonanonymous__89061;
return result_89058;
}
switch (k_89051) {
case 23: d_89049.addEventListener("keyup", laterWrapper_89078(), false);

break;
case 22: d_89049.addEventListener("keyup", enterWrapper_89064(), false);

break;
default: 
d_89049.addEventListener(toEventName_76455[k_89051], stdWrapper_89053(), false);
break;
}
}
function vnodeToDom_89120(n_89122) {

var result_89123 = null;
BeforeRet: do {
if ((n_89122.kind == 0)) {
result_89123 = document.createTextNode(n_89122.text);
n_89122.dom = result_89123;
}
else {
if ((n_89122.kind == 3)) {
var x_89152 = vcomponents_87126[0][n_89122.text](n_89122.kids);
result_89123 = vnodeToDom_89120(x_89152);
n_89122.key = key_89013(result_89123);
n_89122.dom = result_89123;
break BeforeRet;
}
else {
if ((n_89122.kind == 4)) {
result_89123 = dcomponents_87138[0][n_89122.text](n_89122.kids);
n_89122.key = key_89013(result_89123);
n_89122.dom = result_89123;
break BeforeRet;
}
else {
result_89123 = document.createElement(toTag_76449[n_89122.kind]);
n_89122.dom = result_89123;
L1: do {
var k_89172 = null;
L2: do {
var i_89425 = 0;
var colontmp__89427 = 0;
colontmp__89427 = (n_89122.kids != null ? n_89122.kids.length : 0);
var i_89429 = 0;
L3: do {
L4: while (true) {
if (!(i_89429 < colontmp__89427)) break L4;
i_89425 = i_89429;
k_89172 = n_89122.kids[i_89425];
result_89123.appendChild(vnodeToDom_89120(k_89172));
i_89429 += 1;
}
} while(false);
} while(false);
} while(false);
if (!((n_89122.text == null))) {
result_89123.value = n_89122.text;
}

}
}}
if (!((n_89122.id == null))) {
result_89123.id = n_89122.id;
}

if (!((n_89122.class == null))) {
result_89123.className = n_89122.class;
}

if ((0 <= n_89122.key)) {
result_89123.karaxKey = n_89122.key;
}

L5: do {
var k_89173 = null;
var v_89174 = null;
L6: do {
var i_89434 = 0;
var colontmp__89436 = 0;
colontmp__89436 = ((n_89122.attrs != null ? n_89122.attrs.length : 0) - 2);
var res_89438 = 0;
L7: do {
L8: while (true) {
if (!(res_89438 <= colontmp__89436)) break L8;
i_89434 = res_89438;
k_89173 = n_89122.attrs[i_89434];
v_89174 = n_89122.attrs[(i_89434 + 1)];
if (!((v_89174 == null))) {
result_89123.setAttribute(k_89173, v_89174);
}

res_89438 += 2;
}
} while(false);
} while(false);
} while(false);
L9: do {
var e_89402 = 0;
var h_89403 = null;
var colontmp__89442 = null;
colontmp__89442 = n_89122.events;
var i_89445 = 0;
var L_89447 = (colontmp__89442 != null ? colontmp__89442.length : 0);
L10: do {
L11: while (true) {
if (!(i_89445 < L_89447)) break L11;
e_89402 = colontmp__89442[i_89445]["Field0"];
h_89403 = colontmp__89442[i_89445]["Field1"];
wrapEvent_89047(result_89123, n_89122, e_89402, h_89403);
i_89445 += 1;
}
} while(false);
} while(false);
if (((n_89122 == toFocusV_89022[0]) && (toFocus_89021[0] === null))) {
toFocus_89021[0] = result_89123;
}

} while (false); 
return result_89123;
}
function replaceById_89484(id_89486, newTree_89487) {

var x_89488 = document.getElementById(id_89486);
x_89488.parentNode.replaceChild(newTree_89487, x_89488);
}
function eq_76620(a_76622, b_76623) {

var result_76624 = false;
BeforeRet: do {
if (!((a_76622.kind == b_76623.kind))) {
result_76624 = false;
break BeforeRet;
}

if (!((a_76622.id == b_76623.id))) {
result_76624 = false;
break BeforeRet;
}

if (!((a_76622.class == b_76623.class))) {
result_76624 = false;
break BeforeRet;
}

if (!((a_76622.key == b_76623.key))) {
result_76624 = false;
break BeforeRet;
}

if (!((a_76622.kind == 0))) {
if (!(((a_76622.kids != null ? a_76622.kids.length : 0) == (b_76623.kids != null ? b_76623.kids.length : 0)))) {
result_76624 = false;
break BeforeRet;
}

L1: do {
var i_76672 = 0;
var colontmp__76705 = 0;
colontmp__76705 = (a_76622.kids != null ? a_76622.kids.length : 0);
var i_76708 = 0;
L2: do {
L3: while (true) {
if (!(i_76708 < colontmp__76705)) break L3;
i_76672 = i_76708;
if (!(eq_76620(a_76622.kids[i_76672], b_76623.kids[i_76672]))) {
result_76624 = false;
break BeforeRet;
}

i_76708 += 1;
}
} while(false);
} while(false);
}

if (!((a_76622.text == b_76623.text))) {
result_76624 = false;
break BeforeRet;
}

if (!(((a_76622.attrs != null ? a_76622.attrs.length : 0) == (b_76623.attrs != null ? b_76623.attrs.length : 0)))) {
result_76624 = false;
break BeforeRet;
}

L4: do {
var i_76703 = 0;
var colontmp__76711 = 0;
colontmp__76711 = (a_76622.attrs != null ? a_76622.attrs.length : 0);
var i_76714 = 0;
L5: do {
L6: while (true) {
if (!(i_76714 < colontmp__76711)) break L6;
i_76703 = i_76714;
if (!((a_76622.attrs[i_76703] == b_76623.attrs[i_76703]))) {
result_76624 = false;
break BeforeRet;
}

i_76714 += 1;
}
} while(false);
} while(false);
result_76624 = true;
} while (false); 
return result_76624;
}
function sameAttrs_77076(a_77078, b_77079) {

var result_77080 = false;
BeforeRet: do {
if (((a_77078.attrs != null ? a_77078.attrs.length : 0) == (b_77079.attrs != null ? b_77079.attrs.length : 0))) {
result_77080 = true;
L1: do {
var i_77111 = 0;
var colontmp__77113 = 0;
colontmp__77113 = (a_77078.attrs != null ? a_77078.attrs.length : 0);
var i_77116 = 0;
L2: do {
L3: while (true) {
if (!(i_77116 < colontmp__77113)) break L3;
i_77111 = i_77116;
if (!((a_77078.attrs[i_77111] == b_77079.attrs[i_77111]))) {
result_77080 = false;
break BeforeRet;
}

i_77116 += 1;
}
} while(false);
} while(false);
}

} while (false); 
return result_77080;
}
function equalsShallow_89489(a_89491, b_89492) {

var Tmp1;
var Tmp2;
var result_89493 = false;
BeforeRet: do {
if (!(a_89491.key == -1)) Tmp1 = false; else {Tmp1 = (b_89492.key == -1); }if (Tmp1) {
result_89493 = eq_76620(a_89491, b_89492);
break BeforeRet;
}
else {
if (!((a_89491.kind == b_89492.kind))) {
result_89493 = false;
break BeforeRet;
}

if (!((a_89491.id == b_89492.id))) {
result_89493 = false;
break BeforeRet;
}

if (!((a_89491.key == b_89492.key))) {
result_89493 = false;
break BeforeRet;
}

if ((a_89491.kind == 0)) {
if (!((a_89491.text == b_89492.text))) {
result_89493 = false;
break BeforeRet;
}

}
else {
if ((a_89491.kind == 3)) Tmp2 = true; else {Tmp2 = (a_89491.kind == 4); }if (Tmp2) {
if (!((a_89491.text == b_89492.text))) {
result_89493 = false;
break BeforeRet;
}

}
}
if (!(sameAttrs_77076(a_89491, b_89492))) {
result_89493 = false;
break BeforeRet;
}

if (!((a_89491.class == b_89492.class))) {
result_89493 = false;
break BeforeRet;
}

result_89493 = true;
break BeforeRet;
}

} while (false); 
return result_89493;
}
function len_76893(x_76895) {

var result_76896 = 0;
result_76896 = (x_76895.kids != null ? x_76895.kids.length : 0);
return result_76896;
}
function print_89599(s_89601, ident_89602) {

}
function printChildren_89591(parent_89593) {

var result_89594 = null;
return result_89594;
}
function X5BX5D__76904(x_76906, idx_76907) {

var result_76908 = null;
result_76908 = x_76906.kids[idx_76907];
return result_76908;
}
function printChildren_89595(parent_89597) {

var result_89598 = null;
return result_89598;
}
function isUndefined_47032(x_47036) {

var result_47037 = false;
result_47037 = x_47036 === undefined;return result_47037;
}
function toString_77144(n_77146, result_77148, result_77148_Idx, indent_77149) {

L1: do {
var i_77159 = 0;
var res_77197 = 1;
L2: do {
L3: while (true) {
if (!(res_77197 <= indent_77149)) break L3;
i_77159 = res_77197;
if (result_77148[result_77148_Idx] != null) { addChar(result_77148[result_77148_Idx], 32); } else { result_77148[result_77148_Idx] = [32, 0]; };
res_77197 += 1;
}
} while(false);
} while(false);
if ((0 < (result_77148[result_77148_Idx] != null ? result_77148[result_77148_Idx].length-1 : 0))) {
if (result_77148[result_77148_Idx] != null) { addChar(result_77148[result_77148_Idx], 10); } else { result_77148[result_77148_Idx] = [10, 0]; };
}

if (result_77148[result_77148_Idx] != null) { result_77148[result_77148_Idx] = (result_77148[result_77148_Idx].slice(0, -1)).concat((makeNimstrLit("<").slice(0,-1)).concat(reprEnum(n_77146.kind, NTI76002))); } else { result_77148[result_77148_Idx] = (makeNimstrLit("<").slice(0,-1)).concat(reprEnum(n_77146.kind, NTI76002));};
if (!((n_77146.id == null))) {
if (result_77148[result_77148_Idx] != null) { result_77148[result_77148_Idx] = (result_77148[result_77148_Idx].slice(0, -1)).concat((makeNimstrLit(" id = ").slice(0,-1)).concat(cstrToNimstr(n_77146.id))); } else { result_77148[result_77148_Idx] = (makeNimstrLit(" id = ").slice(0,-1)).concat(cstrToNimstr(n_77146.id));};
}

if (!((n_77146.class == null))) {
if (result_77148[result_77148_Idx] != null) { result_77148[result_77148_Idx] = (result_77148[result_77148_Idx].slice(0, -1)).concat((makeNimstrLit(" class = ").slice(0,-1)).concat(cstrToNimstr(n_77146.class))); } else { result_77148[result_77148_Idx] = (makeNimstrLit(" class = ").slice(0,-1)).concat(cstrToNimstr(n_77146.class));};
}

L4: do {
var k_77166 = null;
var v_77167 = null;
L5: do {
var i_77205 = 0;
var colontmp__77207 = 0;
colontmp__77207 = ((n_77146.attrs != null ? n_77146.attrs.length : 0) - 2);
var res_77209 = 0;
L6: do {
L7: while (true) {
if (!(res_77209 <= colontmp__77207)) break L7;
i_77205 = res_77209;
k_77166 = n_77146.attrs[i_77205];
v_77167 = n_77146.attrs[(i_77205 + 1)];
if (result_77148[result_77148_Idx] != null) { result_77148[result_77148_Idx] = (result_77148[result_77148_Idx].slice(0, -1)).concat((makeNimstrLit(" ").slice(0,-1)).concat(cstrToNimstr(k_77166).slice(0,-1),makeNimstrLit(" = ").slice(0,-1),cstrToNimstr(v_77167))); } else { result_77148[result_77148_Idx] = (makeNimstrLit(" ").slice(0,-1)).concat(cstrToNimstr(k_77166).slice(0,-1),makeNimstrLit(" = ").slice(0,-1),cstrToNimstr(v_77167));};
res_77209 += 2;
}
} while(false);
} while(false);
} while(false);
if (result_77148[result_77148_Idx] != null) { result_77148[result_77148_Idx] = (result_77148[result_77148_Idx].slice(0, -1)).concat(makeNimstrLit(">\x0A")); } else { result_77148[result_77148_Idx] = makeNimstrLit(">\x0A");};
if ((n_77146.kind == 0)) {
add_37829(result_77148, result_77148_Idx, n_77146.text);
}
else {
if (!((n_77146.text == null))) {
if (result_77148[result_77148_Idx] != null) { result_77148[result_77148_Idx] = (result_77148[result_77148_Idx].slice(0, -1)).concat(makeNimstrLit(" value = ")); } else { result_77148[result_77148_Idx] = makeNimstrLit(" value = ");};
add_37829(result_77148, result_77148_Idx, n_77146.text);
}

L8: do {
var child_77177 = null;
L9: do {
var i_77216 = 0;
var colontmp__77218 = 0;
colontmp__77218 = (n_77146.kids != null ? n_77146.kids.length : 0);
var i_77220 = 0;
L10: do {
L11: while (true) {
if (!(i_77220 < colontmp__77218)) break L11;
i_77216 = i_77220;
child_77177 = n_77146.kids[i_77216];
toString_77144(child_77177, result_77148, result_77148_Idx, (indent_77149 + 2));
i_77220 += 1;
}
} while(false);
} while(false);
} while(false);
}

L12: do {
var i_77187 = 0;
var res_77224 = 1;
L13: do {
L14: while (true) {
if (!(res_77224 <= indent_77149)) break L14;
i_77187 = res_77224;
if (result_77148[result_77148_Idx] != null) { addChar(result_77148[result_77148_Idx], 32); } else { result_77148[result_77148_Idx] = [32, 0]; };
res_77224 += 1;
}
} while(false);
} while(false);
if (result_77148[result_77148_Idx] != null) { result_77148[result_77148_Idx] = (result_77148[result_77148_Idx].slice(0, -1)).concat((makeNimstrLit("\x0A</").slice(0,-1)).concat(reprEnum(n_77146.kind, NTI76002).slice(0,-1),makeNimstrLit(">"))); } else { result_77148[result_77148_Idx] = (makeNimstrLit("\x0A</").slice(0,-1)).concat(reprEnum(n_77146.kind, NTI76002).slice(0,-1),makeNimstrLit(">"));};
}
function dollar__77401(n_77403) {

var result_77404 = null;
var res_77405 = /**/[makeNimstrLit("")];
toString_77144(n_77403, res_77405, 0, 0);
result_77404 = toJSStr(res_77405[0]);
return result_77404;
}
function newSeq_89632(len_89636) {

var result_89638 = null;
result_89638 = new Array(len_89636); for (var i=0;i<len_89636;++i) {result_89638[i]=0;}return result_89638;
}
function longestIncreasingSubsequence_89603(a_89606) {

var result_89608 = null;
if (result_89608 != null) { result_89608.push(0); } else { result_89608 = [0]; };
var parent_89663 = newSeq_89632((a_89606 != null ? a_89606.length : 0));
L1: do {
var i_89680 = 0;
var colontmp__89730 = 0;
colontmp__89730 = (a_89606 != null ? a_89606.length : 0);
var i_89733 = 0;
L2: do {
L3: while (true) {
if (!(i_89733 < colontmp__89730)) break L3;
i_89680 = i_89733;
L4: do {
var j_89688 = result_89608[((result_89608 != null ? result_89608.length : 0) - 1)];
if ((a_89606[j_89688] < a_89606[i_89680])) {
parent_89663[i_89680] = j_89688;
if (result_89608 != null) { result_89608.push(i_89680); } else { result_89608 = [i_89680]; };
break L4;
}

var left_89699 = 0;
var right_89707 = ((result_89608 != null ? result_89608.length : 0) - 1);
L5: do {
L6: while (true) {
if (!(left_89699 < right_89707)) break L6;
var mid_89708 = Math.floor((left_89699 + right_89707) / 2);
if ((a_89606[result_89608[mid_89708]] < a_89606[i_89680])) {
left_89699 = (mid_89708 + 1);
}
else {
right_89707 = mid_89708;
}

}
} while(false);
if ((a_89606[i_89680] < a_89606[result_89608[left_89699]])) {
if ((0 < left_89699)) {
parent_89663[i_89680] = result_89608[(left_89699 - 1)];
}

result_89608[left_89699] = i_89680;
}

} while(false);
i_89733 += 1;
}
} while(false);
} while(false);
var pos_89716 = (result_89608 != null ? result_89608.length : 0);
var v_89717 = result_89608[(pos_89716 - 1)];
L7: do {
L8: while (true) {
if (!(0 < pos_89716)) break L8;
result_89608[pos_89716] = v_89717;
v_89717 = parent_89663[v_89717];
pos_89716 -= 1;
}
} while(false);
return result_89608;
}
function newSeq_90227(len_90231) {

var result_90233 = null;
result_90233 = new Array(len_90231); for (var i=0;i<len_90231;++i) {result_90233[i]=false;}return result_90233;
}
function updateElement_89736(parent_89738, current_89739, newNode_89740, oldNode_89741, ident_89742) {

var Tmp5;
var Tmp6;
var Tmp9;
var Tmp10;
var Tmp13;
var Tmp14;
var Tmp38;
newNode_89740.dom = oldNode_89741.dom;
if (!(equalsShallow_89489(newNode_89740, oldNode_89741))) {
oldNode_89741.dom = null;
var n_89743 = vnodeToDom_89120(newNode_89740);
if ((parent_89738 == null)) {
replaceById_89484("ROOT", n_89743);
}
else {
parent_89738.replaceChild(n_89743, current_89739);
}

}
else {
if (!((newNode_89740.kind == 0))) {
var newLength_89764 = len_76893(newNode_89740);
var oldLength_89765 = len_76893(oldNode_89741);
var minLength_89766 = nimMin(newLength_89764, oldLength_89765);
print_89599("----------------", ident_89742);
print_89599("----------------", ident_89742);
var before_90001 = printChildren_89591(current_89739);
var left_90002 = 0;
L1: do {
L2: while (true) {
if (!((left_90002 < minLength_89766) && equalsShallow_89489(X5BX5D__76904(newNode_89740, left_90002), X5BX5D__76904(oldNode_89741, left_90002)))) break L2;
updateElement_89736(current_89739, X5BX5D__76904(oldNode_89741, left_90002).dom, X5BX5D__76904(newNode_89740, left_90002), X5BX5D__76904(oldNode_89741, left_90002), (ident_89742 + 1));
left_90002 += 1;
}
} while(false);
var rightOld_90012 = (oldLength_89765 - 1);
var rightNew_90013 = (newLength_89764 - 1);
L3: do {
L4: while (true) {
if (!(left_90002 <= rightOld_90012)) Tmp6 = false; else {Tmp6 = (left_90002 <= rightNew_90013); }if (!Tmp6) Tmp5 = false; else {Tmp5 = equalsShallow_89489(X5BX5D__76904(newNode_89740, rightNew_90013), X5BX5D__76904(oldNode_89741, rightOld_90012)); }if (!Tmp5) break L4;
updateElement_89736(current_89739, X5BX5D__76904(oldNode_89741, rightOld_90012).dom, X5BX5D__76904(newNode_89740, rightNew_90013), X5BX5D__76904(oldNode_89741, rightOld_90012), (ident_89742 + 1));
rightOld_90012 -= 1;
rightNew_90013 -= 1;
}
} while(false);
var leftOld_90032 = left_90002;
var leftNew_90033 = left_90002;
var flag_90034 = false;
print_89599("current", ident_89742);
print_89599(printChildren_89591(current_89739), ident_89742);
print_89599("oldNode", ident_89742);
print_89599(printChildren_89595(oldNode_89741), ident_89742);
print_89599("newNode", ident_89742);
print_89599(printChildren_89595(newNode_89740), ident_89742);
flag_90034 = true;
L7: do {
L8: while (true) {
if (!(leftOld_90032 <= rightOld_90012)) Tmp10 = false; else {Tmp10 = (leftNew_90033 <= rightNew_90013); }if (!Tmp10) Tmp9 = false; else {Tmp9 = equalsShallow_89489(X5BX5D__76904(oldNode_89741, leftOld_90032), X5BX5D__76904(newNode_89740, rightNew_90013)); }if (!Tmp9) break L8;
print_89599(toJSStr((cstrToNimstr(X5BX5D__76904(oldNode_89741, leftOld_90032).id).slice(0,-1)).concat(makeNimstrLit(" ").slice(0,-1),cstrToNimstr(X5BX5D__76904(newNode_89740, rightNew_90013).id))), ident_89742);
print_89599(toJSStr((makeNimstrLit("pos: ").slice(0,-1)).concat(cstrToNimstr((leftOld_90032)+"").slice(0,-1),makeNimstrLit(" ").slice(0,-1),cstrToNimstr((rightNew_90013)+""))), ident_89742);
var nextNode_90035 = null;
if (((rightNew_90013 + 1) < newLength_89764)) {
nextNode_90035 = X5BX5D__76904(newNode_89740, (rightNew_90013 + 1)).dom;
}

print_89599("update", ident_89742);
updateElement_89736(current_89739, X5BX5D__76904(oldNode_89741, leftOld_90032).dom, X5BX5D__76904(newNode_89740, rightNew_90013), X5BX5D__76904(oldNode_89741, leftOld_90032), (ident_89742 + 1));
print_89599("update", ident_89742);
if ((nextNode_90035 == null)) {
current_89739.appendChild(X5BX5D__76904(oldNode_89741, leftOld_90032).dom);
print_89599("append", ident_89742);
}
else {
print_89599("insertBefore", ident_89742);
current_89739.insertBefore(X5BX5D__76904(oldNode_89741, leftOld_90032).dom, nextNode_90035);
}

print_89599(dollar__77401(X5BX5D__76904(oldNode_89741, leftOld_90032)), ident_89742);
leftOld_90032 += 1;
rightNew_90013 -= 1;
}
} while(false);
L11: do {
L12: while (true) {
if (!(leftOld_90032 <= rightOld_90012)) Tmp14 = false; else {Tmp14 = (leftNew_90033 <= rightNew_90013); }if (!Tmp14) Tmp13 = false; else {Tmp13 = equalsShallow_89489(X5BX5D__76904(oldNode_89741, rightOld_90012), X5BX5D__76904(newNode_89740, leftNew_90033)); }if (!Tmp13) break L12;
var nextNode_90065 = X5BX5D__76904(oldNode_89741, leftOld_90032).dom;
updateElement_89736(current_89739, X5BX5D__76904(oldNode_89741, rightOld_90012).dom, X5BX5D__76904(newNode_89740, leftNew_90033), X5BX5D__76904(oldNode_89741, rightOld_90012), (ident_89742 + 1));
current_89739.insertBefore(X5BX5D__76904(oldNode_89741, rightOld_90012).dom, nextNode_90065);
leftNew_90033 += 1;
rightOld_90012 -= 1;
}
} while(false);
if (flag_90034) {
print_89599("after", ident_89742);
print_89599(printChildren_89591(current_89739), ident_89742);
}

var isKeyed_90084 = true;
L15: do {
var i_90094 = 0;
var res_90380 = leftNew_90033;
L16: do {
L17: while (true) {
if (!(res_90380 <= rightNew_90013)) break L17;
i_90094 = res_90380;
if ((X5BX5D__76904(newNode_89740, i_90094).key == -1)) {
isKeyed_90084 = false;
break L15;
}

res_90380 += 1;
}
} while(false);
} while(false);
L18: do {
var i_90104 = 0;
var res_90387 = leftOld_90032;
L19: do {
L20: while (true) {
if (!(res_90387 <= rightOld_90012)) break L20;
i_90104 = res_90387;
if ((X5BX5D__76904(oldNode_89741, i_90104).key == -1)) {
isKeyed_90084 = false;
}

if (!(isKeyed_90084)) {
break L18;
}

res_90387 += 1;
}
} while(false);
} while(false);
if (isKeyed_90084) {
if ((leftNew_90033 < rightNew_90013)) {
L21: do {
var i_90114 = 0;
var res_90394 = leftOld_90032;
L22: do {
L23: while (true) {
if (!(res_90394 <= rightOld_90012)) break L23;
i_90114 = res_90394;
current_89739.removeChild(X5BX5D__76904(oldNode_89741, i_90114).dom);
X5BX5D__76904(oldNode_89741, i_90114).dom = null;
res_90394 += 1;
}
} while(false);
} while(false);
}
else {
var positionByKey_90122 = {};
var positions_90149 = newSeq_89632(0);
L24: do {
var i_90159 = 0;
var res_90401 = leftOld_90032;
L25: do {
L26: while (true) {
if (!(res_90401 <= rightOld_90012)) break L26;
i_90159 = res_90401;
positionByKey_90122[X5BX5D__76904(oldNode_89741, i_90159).key] = i_90159;
res_90401 += 1;
}
} while(false);
} while(false);
L27: do {
var i_90181 = 0;
var res_90408 = leftNew_90033;
L28: do {
L29: while (true) {
if (!(res_90408 <= rightNew_90013)) break L29;
i_90181 = res_90408;
if (positionByKey_90122.hasOwnProperty(X5BX5D__76904(newNode_89740, i_90181).key)) {
if (positions_90149 != null) { positions_90149.push(positionByKey_90122[X5BX5D__76904(newNode_89740, i_90181).key]); } else { positions_90149 = [positionByKey_90122[X5BX5D__76904(newNode_89740, i_90181).key]]; };
}

res_90408 += 1;
}
} while(false);
} while(false);
var lis_90212 = longestIncreasingSubsequence_89603(positions_90149);
var lisPos_90213 = 0;
var isNotRedundant_90251 = newSeq_90227(((rightOld_90012 - leftOld_90032) + 1));
L30: do {
var i_90261 = 0;
var res_90422 = leftNew_90033;
L31: do {
L32: while (true) {
if (!(res_90422 <= rightNew_90013)) break L32;
i_90261 = res_90422;
if ((lisPos_90213 < (lis_90212 != null ? lis_90212.length : 0))) {
var index_90269 = lis_90212[lisPos_90213];
if ((X5BX5D__76904(oldNode_89741, index_90269).key == X5BX5D__76904(newNode_89740, i_90261).key)) {
isNotRedundant_90251[(index_90269 - leftOld_90032)] = true;
updateElement_89736(current_89739, X5BX5D__76904(oldNode_89741, index_90269).dom, X5BX5D__76904(newNode_89740, i_90261), X5BX5D__76904(oldNode_89741, index_90269), (ident_89742 + 1));
lisPos_90213 += 1;
}
else {
if (positionByKey_90122.hasOwnProperty(X5BX5D__76904(newNode_89740, i_90261).key)) {
var oldPos_90299 = positionByKey_90122[X5BX5D__76904(newNode_89740, i_90261).key];
isNotRedundant_90251[(oldPos_90299 - leftOld_90032)] = true;
current_89739.insertBefore(X5BX5D__76904(oldNode_89741, oldPos_90299).dom, X5BX5D__76904(oldNode_89741, index_90269).dom);
}
else {
current_89739.insertBefore(vnodeToDom_89120(X5BX5D__76904(newNode_89740, i_90261)), X5BX5D__76904(oldNode_89741, index_90269).dom);
}

}

}
else {
if (positionByKey_90122.hasOwnProperty(X5BX5D__76904(newNode_89740, i_90261).key)) {
var oldPos_90320 = positionByKey_90122[X5BX5D__76904(newNode_89740, i_90261).key];
isNotRedundant_90251[(oldPos_90320 - leftOld_90032)] = true;
current_89739.appendChild(X5BX5D__76904(oldNode_89741, oldPos_90320).dom);
}
else {
current_89739.appendChild(vnodeToDom_89120(X5BX5D__76904(newNode_89740, i_90261)));
}

}

L33: do {
var i_90330 = 0;
var res_90416 = leftOld_90032;
L34: do {
L35: while (true) {
if (!(res_90416 <= rightOld_90012)) break L35;
i_90330 = res_90416;
if (!(isNotRedundant_90251[i_90330])) {
current_89739.removeChild(X5BX5D__76904(oldNode_89741, i_90330).dom);
}

res_90416 += 1;
}
} while(false);
} while(false);
res_90422 += 1;
}
} while(false);
} while(false);
}

}
else {
print_89599(toJSStr((cstrToNimstr((leftOld_90032)+"").slice(0,-1)).concat(makeNimstrLit(" ").slice(0,-1),cstrToNimstr((rightOld_90012)+"").slice(0,-1),makeNimstrLit(" ").slice(0,-1),cstrToNimstr((leftNew_90033)+"").slice(0,-1),makeNimstrLit(" ").slice(0,-1),cstrToNimstr((rightNew_90013)+""))), ident_89742);
L36: do {
L37: while (true) {
if (!(leftOld_90032 <= rightOld_90012)) Tmp38 = false; else {Tmp38 = (leftNew_90033 <= rightNew_90013); }if (!Tmp38) break L37;
updateElement_89736(current_89739, X5BX5D__76904(oldNode_89741, leftOld_90032).dom, X5BX5D__76904(newNode_89740, leftNew_90033), X5BX5D__76904(oldNode_89741, leftOld_90032), (ident_89742 + 1));
leftNew_90033 += 1;
leftOld_90032 += 1;
}
} while(false);
print_89599("TEMP", ident_89742);
print_89599(printChildren_89591(current_89739), ident_89742);
print_89599(toJSStr((cstrToNimstr((leftOld_90032)+"").slice(0,-1)).concat(makeNimstrLit(" ").slice(0,-1),cstrToNimstr((rightOld_90012)+"").slice(0,-1),makeNimstrLit(" ").slice(0,-1),cstrToNimstr((leftNew_90033)+"").slice(0,-1),makeNimstrLit(" ").slice(0,-1),cstrToNimstr((rightNew_90013)+""))), ident_89742);
print_89599("other part start", ident_89742);
var isPushBack_90349 = ((rightNew_90013 + 1) == newLength_89764);
var nextNode_90350 = null;
if (!(isPushBack_90349)) {
print_89599(toJSStr(cstrToNimstr(((rightNew_90013 + 1))+"")), ident_89742);
nextNode_90350 = X5BX5D__76904(newNode_89740, (rightNew_90013 + 1)).dom;
}

L39: do {
L40: while (true) {
if (!(leftNew_90033 <= rightNew_90013)) break L40;
var node_90351 = vnodeToDom_89120(X5BX5D__76904(newNode_89740, leftNew_90033));
if (isPushBack_90349) {
current_89739.appendChild(node_90351);
}
else {
current_89739.insertBefore(node_90351, nextNode_90350);
}

leftNew_90033 += 1;
}
} while(false);
print_89599("other part finish", ident_89742);
L41: do {
var i_90370 = 0;
var res_90432 = leftOld_90032;
L42: do {
L43: while (true) {
if (!(res_90432 <= rightOld_90012)) break L43;
i_90370 = res_90432;
current_89739.removeChild(X5BX5D__76904(oldNode_89741, i_90370).dom);
X5BX5D__76904(oldNode_89741, i_90370).dom = null;
res_90432 += 1;
}
} while(false);
} while(false);
print_89599("----------------", ident_89742);
print_89599("before", ident_89742);
print_89599(before_90001, ident_89742);
print_89599("finish", ident_89742);
print_89599(printChildren_89591(current_89739), ident_89742);
print_89599("----------------", ident_89742);
print_89599("----------------", ident_89742);
}

}
}
}
function isDirty_87083(key_87085) {

var result_87086 = false;
result_87086 = dirty_87054[0].hasOwnProperty(key_87085);
return result_87086;
}
function unmarkDirty_87071(key_87073) {

delete dirty_87054[0][key_87073];
}
function updateDirtyElements_89529(parent_89531, current_89532, newNode_89533) {

var Tmp1;
var Tmp2;
var Tmp3;
if (!(0 <= newNode_89533.key)) Tmp1 = false; else {Tmp1 = isDirty_87083(newNode_89533.key); }if (Tmp1) {
unmarkDirty_87071(newNode_89533.key);
var n_89534 = vnodeToDom_89120(newNode_89533);
if ((parent_89531 == null)) {
replaceById_89484("ROOT", n_89534);
}
else {
parent_89531.replaceChild(n_89534, current_89532);
}

}
else {
if (!!((newNode_89533.kind == 0))) Tmp3 = false; else {Tmp3 = !((newNode_89533.kind == 3)); }if (!Tmp3) Tmp2 = false; else {Tmp2 = !((newNode_89533.kind == 4)); }if (Tmp2) {
L4: do {
var i_89582 = 0;
var colontmp__89584 = 0;
colontmp__89584 = (len_76893(newNode_89533) - 1);
var res_89587 = 0;
L5: do {
L6: while (true) {
if (!(res_89587 <= colontmp__89584)) break L6;
i_89582 = res_89587;
updateDirtyElements_89529(current_89532, current_89532.childNodes[i_89582], X5BX5D__76904(newNode_89533, i_89582));
res_89587 += 1;
}
} while(false);
} while(false);
}
}
}
function dodraw_90601() {

BeforeRet: do {
if ((dorender_89480[0] === null)) {
break BeforeRet;
}

var newtree_90609 = dorender_89480[0]();
newtree_90609.id = "ROOT";
toFocus_89021[0] = null;
if ((currentTree_89481[0] == null)) {
currentTree_89481[0] = newtree_90609;
var asdom_90621 = vnodeToDom_89120(currentTree_89481[0]);
replaceById_89484("ROOT", asdom_90621);
}
else {
var olddom_90622 = document.getElementById("ROOT");
updateElement_89736(null, olddom_90622, newtree_90609, currentTree_89481[0], 0);
if (someDirty_87055[0]) {
updateDirtyElements_89529(null, olddom_90622, newtree_90609);
someDirty_87055[0] = false;
}

currentTree_89481[0] = newtree_90609;
}

if (!((toFocus_89021[0] == null))) {
toFocus_89021[0].focus();
}

} while (false); 
}
function redraw_90639() {

window.requestAnimationFrame(dodraw_90601);
}
function addEventHandler_90818(n_90820, k_90821, action_90822) {

function wrapper_90823(ev_90825, n_90826) {

action_90822(ev_90825, n_90826);
redraw_90639();
}
addEventListener_77118(n_90820, k_90821, wrapper_90823);
}
function text_77012(s_77014) {

var result_77015 = null;
result_77015 = {kind: 0, text: s_77014, key: -1, id: null, class: null, track: 0, kids: null, attrs: null, events: null, dom: null};
return result_77015;
}
function createTableCell_94091(id_94093) {

function tableCellClick_94095(ev_94098, n_94099) {

console.log(("Clicked" + id_94093));
}
var result_94094 = null;
var tmp_94112 = tree_76933(95, []);
tmp_94112.class = "TableCell";
addEventHandler_90818(tmp_94112, 0, tableCellClick_94095);
add_76914(tmp_94112, text_77012(id_94093));
result_94094 = tmp_94112;
return result_94094;
}
function createTableRow_94115(item_94117) {

var Tmp1;
var result_94118 = null;
if (item_94117.active) {
Tmp1 = "TableRow active";
}
else {
Tmp1 = "TableRow";
}

var className_94119 = Tmp1;
var tmp_94126 = tree_76933(94, []);
tmp_94126.class = className_94119;
setAttr_76716(tmp_94126, "data-id", ((item_94117.id)+''));
tmp_94126.key = item_94117.id;
add_76914(tmp_94126, createTableCell_94091(("#" + ((item_94117.id)+''))));
L2: do {
var i_94143 = 0;
var colontmp__94146 = 0;
colontmp__94146 = (item_94117.props != null ? item_94117.props.length : 0);
var i_94149 = 0;
L3: do {
L4: while (true) {
if (!(i_94149 < colontmp__94146)) break L4;
i_94143 = i_94149;
add_76914(tmp_94126, createTableCell_94091(item_94117.props[i_94143]));
i_94149 += 1;
}
} while(false);
} while(false);
result_94118 = tmp_94126;
return result_94118;
}
function tableCreateVNode_94151(data_94153) {

var result_94154 = null;
var tmp_94162 = tree_76933(87, []);
tmp_94162.class = "Table";
var tmp_94168 = tree_76933(91, []);
L1: do {
var child_94402 = null;
var colontmp__94406 = null;
colontmp__94406 = data_94153.items;
var i_94409 = 0;
var L_94411 = (colontmp__94406 != null ? colontmp__94406.length : 0);
L2: do {
L3: while (true) {
if (!(i_94409 < L_94411)) break L3;
child_94402 = colontmp__94406[i_94409];
add_76914(tmp_94168, createTableRow_94115(child_94402));
i_94409 += 1;
}
} while(false);
} while(false);
add_76914(tmp_94162, tmp_94168);
result_94154 = tmp_94162;
return result_94154;
}
function createAnimBox_94412(item_94414) {

var result_94415 = null;
var time_94416 = item_94414.time;
var t10_94418 = Math.floor(time_94416 % 10);
var color_94420 = (t10_94418 / 1.0000000000000000e+01);
var divStyles_94421 = (((("border-radius: " + ((t10_94418)+'')) + "px; background: rgba(0,0,0,") + toJSStr(cstrToNimstr((color_94420)+""))) + ")");
var tmp_94428 = tree_76933(41, []);
tmp_94428.class = "AnimBox";
setAttr_76716(tmp_94428, "data-id", ((item_94414.id)+''));
tmp_94428.key = item_94414.id;
setAttr_76716(tmp_94428, "style", divStyles_94421);
result_94415 = tmp_94428;
return result_94415;
}
function animCreateVNode_94432(data_94434) {

var result_94435 = null;
var tmp_94442 = tree_76933(41, []);
tmp_94442.class = "Anim";
L1: do {
var child_94602 = null;
var colontmp__94605 = null;
colontmp__94605 = data_94434.items;
var i_94608 = 0;
var L_94610 = (colontmp__94605 != null ? colontmp__94605.length : 0);
L2: do {
L3: while (true) {
if (!(i_94608 < L_94610)) break L3;
child_94602 = colontmp__94605[i_94608];
add_76914(tmp_94442, createAnimBox_94412(child_94602));
i_94608 += 1;
}
} while(false);
} while(false);
result_94435 = tmp_94442;
return result_94435;
}
function createTreeNode_94611(data_94613) {

var result_94614 = null;
var tmp_94622 = tree_76933(34, []);
tmp_94622.class = "TreeNode";
L1: do {
var n_94802 = null;
var colontmp__94812 = null;
colontmp__94812 = data_94613.children;
var i_94815 = 0;
var L_94817 = (colontmp__94812 != null ? colontmp__94812.length : 0);
L2: do {
L3: while (true) {
if (!(i_94815 < L_94817)) break L3;
n_94802 = colontmp__94812[i_94815];
if (n_94802.container) {
add_76914(tmp_94622, createTreeNode_94611(n_94802));
}
else {
var tmp_94808 = tree_76933(35, []);
tmp_94808.class = "TreeLeaf";
add_76914(tmp_94808, text_77012(((n_94802.id)+'')));
add_76914(tmp_94622, tmp_94808);
}

i_94815 += 1;
}
} while(false);
} while(false);
result_94614 = tmp_94622;
return result_94614;
}
function treeCreateVNode_94818(data_94820) {

var result_94821 = null;
var tmp_94828 = tree_76933(41, []);
tmp_94828.class = "Tree";
add_76914(tmp_94828, createTreeNode_94611(data_94820.root));
result_94821 = tmp_94828;
return result_94821;
}
function update_94830() {

var result_94832 = null;
var location_95001 = appState_94089[0].location;
var children_95002 = null;
if ((location_95001 == "table")) {
children_95002 = tableCreateVNode_94151(appState_94089[0].table);
}
else {
if ((location_95001 == "anim")) {
children_95002 = animCreateVNode_94432(appState_94089[0].anim);
}
else {
if ((location_95001 == "tree")) {
children_95002 = treeCreateVNode_94818(appState_94089[0].tree);
}
}}
var tmp_95009 = tree_76933(41, []);
tmp_95009.class = "Main";
add_76914(tmp_95009, children_95002);
result_94832 = tmp_95009;
return result_94832;
}
setRendererOnly_90811(update_94830);
function redrawForce_90801() {

dodraw_90601();
}
function a_95012(state_95014) {

appState_94089[0] = state_95014;
redrawForce_90801();
}
function b_95020(samples_95022) {

document.body.innerHTML = (("<pre>" + JSON.stringify(samples_95022, null, ' ')) + "</pre>");
}
uibench.run(a_95012, b_95020);
